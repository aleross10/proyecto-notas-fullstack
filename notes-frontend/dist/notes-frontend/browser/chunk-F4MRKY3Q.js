import{a as T}from"./chunk-PV4HNX5T.js";import{a as F}from"./chunk-F7EJBQOC.js";import{B as u,D as l,E as o,F as r,H as _,I as d,J as c,L as s,M as x,N as g,P as E,Q as S,U as h,V as N,W as w,X as I,ca as y,da as k,ga as L,n as b,o as f,t as a,w as p,x as C}from"./chunk-CS3A7NQZ.js";var A=(i,t)=>({"border-primary":i,"border-success":t}),D=i=>["/notes/share",i];function O(i,t){i&1&&(o(0,"div",8),s(1," No tienes notas creadas, compartidas o p\xFAblicas visibles. "),r())}function V(i,t){i&1&&(o(0,"span",21),s(1,"P\xFAblica"),r())}function M(i,t){if(i&1&&(o(0,"button",22),s(1," Compartir "),r()),i&2){let e=c().$implicit;l("routerLink",E(1,D,e.id))}}function R(i,t){if(i&1){let e=_();o(0,"button",23),d("click",function(){b(e);let m=c().$implicit,v=c();return f(v.openEditForm(m))}),s(1," Editar "),r()}}function j(i,t){if(i&1){let e=_();o(0,"button",24),d("click",function(){b(e);let m=c().$implicit,v=c();return f(v.onDelete(m.id))}),s(1," Eliminar "),r()}}function P(i,t){if(i&1&&(o(0,"div",9)(1,"div",10)(2,"div",11)(3,"h5",12),s(4),r(),o(5,"p",13),s(6),r(),o(7,"div",14)(8,"span",15),s(9),r(),u(10,V,2,0,"span",16),o(11,"div",17),u(12,M,2,3,"button",18)(13,R,2,0,"button",19)(14,j,2,0,"button",20),r()()()()()),i&2){let e=t.$implicit,n=c();a(),l("ngClass",S(8,A,e.ownerEmail===n.authService.getCurrentUserEmail(),e.isPublic&&e.ownerEmail!==n.authService.getCurrentUserEmail())),a(3),x(e.title),a(2),g("",e.content.substring(0,100),"..."),a(3),g(" Due\xF1o: ",e.ownerEmail===n.authService.getCurrentUserEmail()?"T\xFA":e.ownerEmail," "),a(),l("ngIf",e.isPublic),a(2),l("ngIf",e.ownerEmail===n.authService.getCurrentUserEmail()),a(),l("ngIf",e.ownerEmail===n.authService.getCurrentUserEmail()),a(),l("ngIf",e.ownerEmail===n.authService.getCurrentUserEmail())}}var U=class i{constructor(t,e,n){this.notesService=t;this.authService=e;this.router=n}notes=[];userEmail=null;ngOnInit(){this.authService.getCurrentUserEmail()||this.authService.decodeAndSetCurrentUser(),this.loadNotes()}loadNotes(){this.notesService.getAllNotes().subscribe({next:t=>{this.notes=t,this.userEmail=this.authService.getCurrentUserEmail()},error:t=>{console.error("Error al cargar notas:",t),(t.status===401||t.status===403)&&this.logout()}})}onDelete(t){t!==void 0&&confirm("\xBFEst\xE1s seguro de que quieres eliminar esta nota?")&&this.notesService.deleteNote(t).subscribe({next:()=>{this.loadNotes()},error:e=>{alert(e.error||"No tienes permisos para esta acci\xF3n.")}})}openCreateForm(){this.router.navigate(["/notes/create"])}openEditForm(t){this.router.navigate(["/notes/edit",t.id])}logout(){localStorage.removeItem("auth_token"),this.router.navigate(["/login"])}static \u0275fac=function(e){return new(e||i)(p(F),p(T),p(y))};static \u0275cmp=C({type:i,selectors:[["app-list"]],decls:12,vars:2,consts:[[1,"container","mt-5"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"text-primary"],[1,"btn","btn-warning","me-2",3,"click"],[1,"btn","btn-success",3,"click"],["class","alert alert-info",4,"ngIf"],[1,"row","row-cols-1","row-cols-md-2","row-cols-lg-3","g-4"],["class","col",4,"ngFor","ngForOf"],[1,"alert","alert-info"],[1,"col"],[1,"card","h-100","shadow-sm","border",3,"ngClass"],[1,"card-body","d-flex","flex-column"],[1,"card-title"],[1,"card-text","flex-grow-1","text-muted"],[1,"mt-auto","pt-2","border-top"],[1,"badge","bg-secondary","me-2"],["class","badge bg-info",4,"ngIf"],[1,"mt-2"],["class","btn btn-sm btn-outline-info me-2",3,"routerLink",4,"ngIf"],["class","btn btn-sm btn-outline-secondary me-2",3,"click",4,"ngIf"],["class","btn btn-sm btn-danger",3,"click",4,"ngIf"],[1,"badge","bg-info"],[1,"btn","btn-sm","btn-outline-info","me-2",3,"routerLink"],[1,"btn","btn-sm","btn-outline-secondary","me-2",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"h2",2),s(3,"Mis Notas y Notas Compartidas"),r(),o(4,"div")(5,"button",3),d("click",function(){return n.logout()}),s(6,"Cerrar Sesi\xF3n"),r(),o(7,"button",4),d("click",function(){return n.openCreateForm()}),s(8," Crear Nueva Nota "),r()()(),u(9,O,2,0,"div",5),o(10,"div",6),u(11,P,15,11,"div",7),r()()),e&2&&(a(9),l("ngIf",n.notes.length===0),a(2),l("ngForOf",n.notes))},dependencies:[I,h,N,w,L,k],encapsulation:2})};export{U as ListComponent};
