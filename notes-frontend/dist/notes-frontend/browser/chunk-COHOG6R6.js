import{a as I,b as _,c as b,d as y,e as x,f as D,g as M,h as k,i as A,j as G}from"./chunk-SCEPUA4M.js";import{a as S}from"./chunk-F7EJBQOC.js";import{B as p,D as d,E as i,F as r,G as u,I as f,L as n,M as g,N as h,W as F,X as N,aa as E,ca as C,t as l,w as s,x as v}from"./chunk-CS3A7NQZ.js";function R(m,t){m&1&&(i(0,"div",15),n(1," El t\xEDtulo es obligatorio. "),r())}function T(m,t){m&1&&(i(0,"div",15),n(1," El contenido es obligatorio. "),r())}var P=class m{constructor(t,e,o,a){this.fb=t;this.notesService=e;this.router=o;this.route=a}noteForm;isEditMode=!1;noteId=null;ngOnInit(){this.noteForm=this.fb.group({title:["",b.required],content:["",b.required],isPublic:[!1]}),this.route.paramMap.subscribe(t=>{let e=t.get("id");e&&(this.noteId=+e,this.isEditMode=!0,this.loadNoteData(this.noteId))})}loadNoteData(t){this.notesService.getNoteById(t).subscribe({next:e=>{this.noteForm.patchValue({title:e.title,content:e.content,isPublic:e.isPublic})},error:e=>{console.error("Error al cargar la nota para edici\xF3n:",e),alert("Error: No se pudo cargar la nota o no tienes permisos."),this.router.navigate(["/notes"])}})}onSubmit(){if(this.noteForm.valid){let t=this.noteForm.value;this.isEditMode&&this.noteId?(t.id=this.noteId,this.notesService.updateNote(t).subscribe({next:()=>this.router.navigate(["/notes"]),error:e=>alert("Error al editar: "+(e.error||"Acceso denegado."))})):this.notesService.createNote(t).subscribe({next:()=>{this.router.navigate(["/notes"])},error:e=>{alert("Error al guardar la nota: "+(e.error||"Error desconocido."))}})}}static \u0275fac=function(e){return new(e||m)(s(A),s(S),s(C),s(E))};static \u0275cmp=v({type:m,selectors:[["app-form"]],decls:24,vars:6,consts:[[1,"container","mt-5"],[1,"card","p-4","shadow-sm"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","title",1,"form-label"],["id","title","type","text","formControlName","title",1,"form-control"],["class","text-danger",4,"ngIf"],["for","content",1,"form-label"],["id","content","rows","5","formControlName","content",1,"form-control"],[1,"mb-3","form-check"],["type","checkbox","id","isPublic","formControlName","isPublic",1,"form-check-input"],["for","isPublic",1,"form-check-label"],[1,"d-flex","justify-content-between"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"text-danger"]],template:function(e,o){if(e&1&&(i(0,"div",0)(1,"h2"),n(2),r(),i(3,"div",1)(4,"form",2),f("ngSubmit",function(){return o.onSubmit()}),i(5,"div",3)(6,"label",4),n(7,"T\xEDtulo"),r(),u(8,"input",5),p(9,R,2,0,"div",6),r(),i(10,"div",3)(11,"label",7),n(12,"Contenido"),r(),u(13,"textarea",8),p(14,T,2,0,"div",6),r(),i(15,"div",9),u(16,"input",10),i(17,"label",11),n(18,"Hacer p\xFAblica (Visible para todos los usuarios)"),r()(),i(19,"div",12)(20,"button",13),f("click",function(){return o.router.navigate(["/notes"])}),n(21," Cancelar "),r(),i(22,"button",14),n(23),r()()()()()),e&2){let a,c;l(2),g(o.isEditMode?"Editar Nota":"Crear Nueva Nota"),l(2),d("formGroup",o.noteForm),l(5),d("ngIf",((a=o.noteForm.get("title"))==null?null:a.invalid)&&((a=o.noteForm.get("title"))==null?null:a.touched)),l(5),d("ngIf",((c=o.noteForm.get("content"))==null?null:c.invalid)&&((c=o.noteForm.get("content"))==null?null:c.touched)),l(8),d("disabled",!o.noteForm.valid),l(),h(" ",o.isEditMode?"Guardar Cambios":"Crear Nota"," ")}},dependencies:[N,F,G,D,_,I,y,x,M,k],encapsulation:2})};export{P as FormComponent};
